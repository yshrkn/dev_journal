---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Sidebar from '../components/Sidebar.astro';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;
---

<BaseLayout title={title} description={description} showSidebar={true} maxWidth="wide">
	<article class="blog-post">
		{heroImage && (
			<div class="hero-image">
				<Image src={heroImage} alt={title} />
			</div>
		)}
		
		<header class="post-header">
			<div class="post-meta">
				<FormattedDate date={pubDate} />
				{updatedDate && (
					<div class="last-updated">
						Last updated on <FormattedDate date={updatedDate} />
					</div>
				)}
			</div>
			<h1 class="post-title">{title}</h1>
		</header>
		
		<div class="prose">
			<slot />
		</div>
	</article>

	<Sidebar showToc={true} slot="sidebar" />

	<style>
		.blog-post {
			background: rgb(var(--surface));
			border-radius: var(--border-radius-lg);
			padding: 2.5rem;
			box-shadow: var(--box-shadow);
			border: 1px solid rgb(var(--border));
		}
		
		.hero-image {
			margin: -2.5rem -2.5rem 2rem -2.5rem;
			border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
			overflow: hidden;
		}
		
		.hero-image img {
			width: 100%;
			height: 300px;
			object-fit: cover;
			margin: 0;
			box-shadow: none;
		}
		
		.post-header {
			margin-bottom: 3rem;
			text-align: center;
			padding-bottom: 2rem;
			border-bottom: 1px solid rgb(var(--border));
		}
		
		.post-meta {
			margin-bottom: 1.5rem;
			font-size: 0.875rem;
			color: rgb(var(--text-secondary));
		}
		
		.last-updated {
			margin-top: 0.5rem;
			font-style: italic;
		}
		
		.post-title {
			margin: 0;
			font-size: 2.5rem;
			font-weight: 800;
			line-height: 1.1;
			color: rgb(var(--text-primary));
		}
		
		@media (max-width: 768px) {
			.blog-post {
				padding: 1.5rem;
				border-radius: var(--border-radius);
			}
			
			.hero-image {
				margin: -1.5rem -1.5rem 1.5rem -1.5rem;
				border-radius: var(--border-radius) var(--border-radius) 0 0;
			}
			
			.hero-image img {
				height: 200px;
			}
			
			.post-title {
				font-size: 2rem;
			}
		}
	</style>
</BaseLayout>
